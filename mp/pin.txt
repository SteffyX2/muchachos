#include <LiquidCrystal.h>
LiquidCrystal lcd(8, 9, 4, 5, 6, 7);
unsigned char taster_staro, taster_novo;
int pin,i,x,y,b1000,b100,b10,b1,proverapina;

void setup() {
  Serial.begin(9600);
  lcd.begin(16,2);
  pin = random(10000);
  Serial.println(pin);
  for (i=0;i<4;i++)
  {
  	lcd.setCursor(i,0);
  	lcd.print(0);
  }
  b1000 = 0;
  b100 = 0;
  b10 = 0;
  b1 = 0;
  taster_novo=0;
  taster_staro=0;
  proverapina=0;
  x=0;
  y=0;
  lcd.setCursor(x,y);
  lcd.blink();
}
void loop() {
  taster_novo = ocitaj_taster();
  if(taster_novo != taster_staro)
  {
    switch(taster_novo)
    {
      case 1: // SELECT
      proverapina=1000*b1000+100*b100+10*b10+1*b1;
          if (pin==proverapina)
          {
            lcd.setCursor(0,1);
            lcd.print("Uspesna prijava");
          }
      else if(pin!=proverapina)
      {
      	lcd.setCursor(0,1);
            lcd.print(" Greska");
      }
      
              break;
      case 2: // LEFT
      x--;
		lcd.setCursor(x,y);	
          break;
      case 3: // UP
      if(x==0 && y==0)
        
      {
        if (b1000==9)
        {
        b1000=0;
          lcd.setCursor(x,y);
       lcd.print(b1000);
       delay(100);
        }
        else
        {
        b1000++;
          lcd.setCursor(x,y);
       lcd.print(b1000);
       delay(100);
        }
      }
      else if(x==1 && y==0)
        
      {
        if (b100==9)
        {
        b100=0;
          lcd.setCursor(x,y);
       lcd.print(b100);
       delay(100);
        }
        else
        {
        b100++;
          lcd.setCursor(x,y);
       lcd.print(b100);
       delay(100);
        }
      }
      else if(x==2 && y==1)
        
      {
        if (b10==9)
        {
        b10=0;
          lcd.setCursor(x,y);
       lcd.print(b10);
       delay(100);
        }
        else
        {
        b1000++;
          lcd.setCursor(x,y);
       lcd.print(b10);
       delay(100);
        }
      }
      else if(x==3 && y==0)
        
      {
        if (b1==9)
        {
        b1=0;
          lcd.setCursor(x,y);
       lcd.print(b1);
       delay(100);
        }
        else
        {
        b1++;
          lcd.setCursor(x,y);
       lcd.print(b1);
       delay(100);
        }
      }
      
      break;
      case 4: // DOWN
      if(x==0 && y==0)
        
      {
        if (b1000==9)
        {
        b1000=0;
          lcd.setCursor(x,y);
       lcd.print(b1000);
       delay(100);
        }
        else
        {
        b1000--;
          lcd.setCursor(x,y);
       lcd.print(b1000);
       delay(100);
        }
      }
      else if(x==1 && y==0)
        
      {
        if (b100==9)
        {
        b100=0;
          lcd.setCursor(x,y);
       lcd.print(b100);
       delay(100);
        }
        else
        {
        b100--;
          lcd.setCursor(x,y);
       lcd.print(b100);
       delay(100);
        }
      }
     else if(x==2 && y==0)
        
      {
        if (b10==9)
        {
        b10=0;
          lcd.setCursor(x,y);
       lcd.print(b10);
       delay(100);
        }
        else
        {
        b10--;
          lcd.setCursor(x,y);
       lcd.print(b10);
       delay(100);
        }
      }
      else if(x==3 && y==0)
        
      {
        if (b1==9)
        {
        b1=0;
          lcd.setCursor(x,y);
       lcd.print(b1);
       delay(100);
        }
        else
        {
        b1--;
          lcd.setCursor(x,y);
       lcd.print(b1);
       delay(100);
        }
      }
      
          break;
      case 5: // RIGHT
 		x++;	
     	lcd.setCursor(x,y);	
          break;
      default:
          break;
    }
    
    taster_staro = taster_novo;
  }
}

byte ocitaj_taster()
{
  int tmp = analogRead(0); //stanje tastera se ocitava preko
  //analognog ulaza 0
  if (tmp > 635 && tmp < 645) //SELECT
    return 1;
  if (tmp > 405 && tmp < 415) //LEFT
    return 2;
  if (tmp > 95 && tmp < 105) //UP
    return 3;
  if (tmp > 252 && tmp < 262) //DOWN
    return 4;
  if (tmp < 5) //RIGHT
    return 5;
  return 0; //nije pritisnut nijedan od tastera
}